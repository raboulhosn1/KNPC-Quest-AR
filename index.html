<!DOCTYPE html>
<html>
<head>
    <title>KNPC Quest AR</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/geolib@3.3.1/lib/index.min.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <a-scene embedded arjs="sourceType: webcam; debugUIEnabled: false;">
        <a-assets>
            <a-asset-item id="knpcBooth" src="./knpc_booth.glb"></a-asset-item>
            <a-asset-item id="stage" src="./stage.glb"></a-asset-item>
            <a-asset-item id="knpcLogo" src="./knpc_logo.glb"></a-asset-item>
            <a-asset-item id="glassBoat" src="./glass_boat.glb"></a-asset-item>
            <a-asset-item id="kuwaitTowers" src="./kuwait_towers.glb"></a-asset-item>
            <a-asset-item id="redBarrel" src="./red_barrel.glb"></a-asset-item>
            <a-asset-item id="knpcWorker" src="./knpc_worker.glb"></a-asset-item>
        </a-assets>

        <!-- GPS Entities for AR Placement -->
        <a-entity gps-entity-place="latitude: 29.38833290080186; longitude: 48.003490055566495" 
                  gltf-model="#knpcBooth" scale="1 1 1"></a-entity>

        <a-entity gps-entity-place="latitude: 29.388693957183015; longitude: 48.003310431211574" 
                  gltf-model="#stage" scale="1 1 1"></a-entity>
        
        <a-entity gps-entity-place="latitude: 29.388693957183015; longitude: 48.003310431211574" 
                  gltf-model="#knpcLogo" position="0 3 0" scale="1 1 1"></a-entity>

        <a-entity gps-entity-place="latitude: 29.388453358501053; longitude: 48.003089910222435" 
                  gltf-model="#glassBoat" scale="1 1 1"></a-entity>

        <a-entity gps-entity-place="latitude: 29.389590483399587; longitude: 48.0032380262504" 
                  id="finalStation" gltf-model="#kuwaitTowers" scale="1 1 1"></a-entity>

        <a-entity gps-entity-place="latitude: 29.38833290080186; longitude: 48.003490055566495" 
                  id="redBarrel" gltf-model="#redBarrel" scale="1 1 1"></a-entity>

        <!-- KNPC Worker Roaming at Kuwait Towers -->
        <a-entity id="knpcWorker" gps-entity-place="latitude: 29.389590483399587; longitude: 48.0032380262504"
                  gltf-model="#knpcWorker" scale="1 1 1"
                  animation="property: position; to: 2 0 2; dir: alternate; loop: true; dur: 5000">
        </a-entity>

        <a-camera gps-camera rotation-reader></a-camera>
    </a-scene>

    <script>
        // Display GPS Coordinates for Debugging
        navigator.geolocation.watchPosition(function(position) {
            console.log("GPS: " + position.coords.latitude + ", " + position.coords.longitude);
        }, function(error) {
            console.error("GPS Error: " + error.message);
        }, {
            enableHighAccuracy: true, 
            maximumAge: 0
        });

        // Interactive Logic for Unlocking Locations
        document.addEventListener("DOMContentLoaded", function() {
            let redBarrel = document.getElementById("redBarrel");
            redBarrel.addEventListener("click", function() {
                let uniqueCode = "KNPC" + Math.floor(1000 + Math.random() * 9000);
                alert("ðŸŽ‰ Congratulations! Your Unique Code: " + uniqueCode);
            });
        });
    </script>
</body>
</html>
